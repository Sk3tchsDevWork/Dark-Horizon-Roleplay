<head>
  <meta charset="UTF-8" />
  <title>LiveKit Viewer</title>
</head>

<body>
  <video id="remoteVideo" autoplay playsinline controls muted
    style="width: 100%; height: 100%; background: #000;"></video>

  <script src="https://cdn.jsdelivr.net/npm/livekit-client/dist/livekit-client.umd.min.js"></script>
  <script>
    const params = new URLSearchParams(window.location.search);
    const token = params.get('token');
    const url = params.get('channel');

    const videoElement = document.getElementById('remoteVideo');
    const room = new LivekitClient.Room();


    room.on('trackSubscribed', (track, publication, participant) => {
      if (track.kind === 'video') {
        // Attach track to the existing <video> element by passing it as an argument
        track.attach(videoElement);
      }
    });
    room.connect(url, token)
      .then(() => {
        console.log('Connected to room as viewer');
      })
      .catch(console.error);
  </script>
</body>

</html>